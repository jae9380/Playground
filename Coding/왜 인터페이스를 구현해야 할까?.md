#  μ„λΉ„μ¤ μΈν„°νμ΄μ¤λ” κΌ­ ν•„μ”ν• λ¶€λ¶„μΌκΉ?? π¤”   

λ‚΄κ°€ μλ°”μ™€ μ¤ν”„λ§ λ¶€νΈλ¥Ό κ³µλ¶€ν•λ”λ° κ°€λ” ν• λ²μ”© λ“¤μ–΄λ³Έ μ΅°μ–Έμ΄ μλ‹¤.

> ## "μ„λΉ„μ¤ κµ¬ν„μ„ μΈν„°νμ΄μ¤ κµ¬ν„ μ—†λ” λ°©μ‹ λ§κ³ , μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” λ°©μ‹μ΄ μΆ‹μµλ‹λ‹¤."   
   
![](https://i.postimg.cc/SQc9qHCd/03ff6b53afca74d8b2ede0be04d88970.jpg)

**μ™ μΈν„°νμ΄μ¤λ΅ μ„λΉ„μ¤λ¥Ό κµ¬ν„ν•λ” λ°©μ‹μ΄ μΆ‹λ‹¤λ” κ²ƒμΌκΉ??**    

μ†”μ§ν λ§μ„ ν•λ©΄ ν•΄λ‹Ή λ°©λ²•μ„ μ‚¬μ©ν• κ²½ν—λ„ μ—†κ³ , μ™ μ΄λ° λ°©λ²•μ„ μ΄μ©ν•λΌλ” λ»μΈμ§€ λ¨λ¥΄κ² λ‹¤.    
μ¤μ¤νλ ¤ λ‚λ” _**'κ·Έλƒ¥ ν•λ λ°©λ²•λ€λ΅ ν•λ‚μ ν΄λμ¤λ§ κµ¬ν„ν•λ©΄ λλ” λ‚΄μ©μΈλ° κΌ­ μΈν„°νμ΄μ¤λ¥Ό μ¶”κ°€λ΅ λ§λ“¤μ–΄μ•Ό ν—¤??'**_ λΌλ” μƒκ°μ„ ν–λ‹¤.   

κ·Έλμ„ μ¤λ μ΄μ— λ€ν•μ—¬ μ•μ•„λ³Ό μƒκ°μ΄λ‹¤.   

## κ°μ²΄μ§€ν–¥ ν”„λ΅κ·Έλλ° (Object-Oriented Programming, OOP)   

μ„λΉ„μ¤ κµ¬ν„ μ‹ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” λ°©μ‹μ€ `OOP`μ μ›μΉ™ μ¤‘ `μ¶”μƒν™”(abstraction)`μ™€ `λμ¨ν• κ²°ν•©(loose coupling)`μ„ μ‹¤ν„ν•κΈ° μ„ν• ν•µμ‹¬ λ„κµ¬κ°€ λ°”λ΅ μΈν„°νμ΄μ¤μ΄κΈ° λ•λ¬Έμ΄λ‹¤.   

μΆ€ λ” μμ„Έν μ„¤λ…μ„ ν•λ©΄ λ‹¤μκ³Ό κ°™μ€ κΈ°μ μ  λ‹¨μ κ³Ό κ·Έλ΅ μΈν•μ—¬ λ°μƒν•λ” λ¬Έμ μ λ“¤μ„ λ³΄μ™„ν•κΈ° μ„ν•΄μ„λ‹¤.   

### κµ¬ν„μ²΄μ— λ€ν• κ°•ν• μμ΅΄μ„±   

μμ  μ½”λ“ μƒν™©μ„ μ΄μ•ΌκΈ° ν•λ©΄ ν΄λμ¤κ°€ νΉμ • κµ¬ν„μ²΄μ— μ§μ ‘ μμ΅΄ν•λ©΄, κ·Έ κµ¬ν„μ²΄μ λ³€κ²½μ΄ λ‹¤λ¥Έ μ½”λ“μ— ν° μν–¥μ„ μ¤€λ‹¤.      

μλ¥Ό λ“¤μ–΄, νΉμ • λ°μ΄ν„°λ² μ΄μ¤λ‚ APIλ¥Ό μ‚¬μ©ν•λ” μ½”λ“μ—μ„ μƒλ΅μ΄ μ‹μ¤ν…μΌλ΅ λ³€κ²½ν•  λ•, κΈ°μ΅΄ μ½”λ“μ—μ„ ν•΄λ‹Ή κµ¬ν„μ²΄μ— μΆ…μ†λ λ¨λ“  λ¶€λ¶„μ„ μμ •ν•΄μ•Ό ν•λ‹¤λ” λ¬Έμ μ μ΄ μλ‹¤.   

```java
// Bad Practice (κµ¬ν„μ²΄μ— μ§μ ‘ μμ΅΄)
public class UserService {
    private MySQLUserRepository userRepository; // MySQL DBμ— μΆ…μ†

    public UserService() {
        userRepository = new MySQLUserRepository();
    }

    public void saveUser(User user) {
        userRepository.save(user);
    }
}
```

μ΄ μƒν™©μ—μ„ `UserService`κ°€ `MySQLUserRepository`λ¥Ό κµ¬μ²΄μ μΌλ΅ μμ΅΄μ„ ν•κ³  μλ” μƒν™©μ΄λ‹¤.   

λ§μ•½ μ—¬κΈ°μ„ μƒλ΅μ΄ μ €μ¥μ†λ΅ λ³€κ²½μ„ ν•λ‹¤κ±°λ‚, μ €μ¥μ†λ¥Ό μ¶”κ°€λ¥Ό ν•λ” μƒν™©μ΄ μƒκΈ°λ©΄ κΈ°μ΅΄μ μ½”λ“λ¥Ό μμ •μ„ ν•΄μ•Όν•λ‹¤.   

μ΄λ” `SOLID`μ— μμ–΄ `κ°λ°© νμ‡„ μ›μΉ™ (Open-Close Principle, OCP)`μ— μ„λ°°λλ‹¤.

### OCP

> ### κ°λ°© νν™° μ›μΉ™ (Open-Close Principle, OCP)    
> μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤.   
> μ‰½κ² μ„¤λ…μ„ ν•λ©΄, κΈ°μ΅΄μ μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³  κΈ°λ¥μ„ μμ •, μ¶”κ°€ν•  μ μλ„λ΅ μ„¤κ³„ν•΄μ•Όν•λ‹¤.
>
> μ–΄λ–¤ λ¶€λ¶„μ„ μμ •ν•  λ•, ν•΄λ‹Ή λ¶€λ¶„μ„ μ΄μ©ν•λ” λ¨λ“  λ¶€λ¶„μ„ μμ • ν•΄μ•Ό ν•λ‹¤λ©΄ μ μ§€λ³΄μκ°€ λ³µμ΅ν•΄μ§„λ‹¤.    
> κ·Έλ ‡κΈ° λ•λ¬Έμ— `OCP`μ„ μ μ©ν•΄μ„ κΈ°μ΅΄ μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•μ•„λ„ κΈ°λ¥μ„ μμ •, μ¶”κ°€ν•  μ μλ„λ΅ ν•΄μ•Όν•λ‹¤.
>
> `OCP`λ¥Ό μ§€ν‚¤μ§€ μ•μΌλ©΄ κ°μ²΄μ§€ν–¥ ν”„λ΅κ·Έλλ°μ μ¥μ μΈ μ μ—°μ„±, μ¬μ‚¬μ©μ„±, μ μ§€λ³΄μμ„± λ“±μ„ ν™μ©ν•μ§€ λ»ν•κ² λλ‹¤.

**κ·ΈλΌ κΈ°μ΅΄ μ½”λ“μ λ³€κ²½μ—†μ΄ μ–΄λ–»κ² κµ¬ν„μ„ ν•΄μ•Ό ν•΄λ‹Ή μ›μΉ™μ„ μ§€ν‚¤λ” κ²ƒμΌκΉ?**

κΈ°μ΅΄ λ°©μ‹κ³Όλ” λ‹¬λ¦¬ μΈν„°νμ΄μ¤ κµ¬ν„ν•λ” λ°©μ‹μ€ μΈν„°νμ΄μ¤κ°€ κµ¬ν„μ²΄μ™€μ κ²°ν•©μ„ λμ–΄λ‚΄κ³  κ·Έ λ€μ‹  μΈν„°νμ΄μ¤λΌλ” μ¶”μƒν™”λ κ°λ…μ— μμ΅΄ν•κ² λ§λ“ λ‹¤.    

μ΄λ¥Ό ν†µν•΄ μƒλ΅μ΄ κµ¬ν„μ²΄λ¥Ό μ¶”κ°€ν•κ±°λ‚ λ³€κ²½ν•λ”λΌλ„ μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ μ½”λ“ λ³€κ²½μ„ μµμ†ν™”ν•  μ μκ² λλ‹¤.
```java
// Good Practice (μΈν„°νμ΄μ¤μ— μμ΅΄)
public class UserService {
    private UserRepository userRepository; // μ¶”μƒν™”λ UserRepository μΈν„°νμ΄μ¤

    public UserService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    public void saveUser(User user) {
        userRepository.save(user);
    }
}

public interface UserRepository {
    void save(User user);
}

public class MySQLUserRepository implements UserRepository {
    @Override
    public void save(User user) {
        // MySQLμ— μ‚¬μ©μ μ €μ¥ λ΅μ§
    }
}
```

μ΄ μ²λΌ κµ¬ν„μ„ ν•λ‹¤λ©΄ `UserService`κ°€ `UserRepository` μΈν„°νμ΄μ¤μ— μμ΅΄ν•λ„λ΅ λ³€κ²½ν•λ©΄μ„, μ‹¤μ  κµ¬ν„μ²΄λ” μ£Όμ…λλ‹¤.    

κ·ΈλΌ `MySQLUserRepository`λ€μ‹  `MongoDBUserRepository`λ΅ λ³€κ²½μ„ ν•λ‹¤κ³  κ°€μ •μ„ ν•μ   

μƒλ΅μ΄ κµ¬ν„μ²΄ `MongoDBUserRepository` κµ¬ν„μ²΄λ¥Ό μƒμ„±μ„ ν•λ©΄ λμ΄λ‹¤.
```java
public class MongoDBUserRepository implements UserRepository {
    @Override
    public void save(User user) {
        // MongoDBμ— μ €μ¥ν•λ” λ΅μ§
    }
}
```

```java
        // MongoDBUserRepositoryμ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±
        UserRepository userRepository = new MongoDBUserRepository();
        
        // UserServiceμ— MongoDBUserRepositoryλ¥Ό μ£Όμ…
        UserService userService = new UserService(userRepository);
        
```

μ΄μ  `UserService`μΈμ¤ν„΄μ¤λ¥Ό μƒμ„± ν•  λ• μ›ν•λ” λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μ£Όμ…ν•λ©΄ κΈ°μ΅΄μ μ½”λ“ μμ • μ—†μ΄ λ³€κ²½μ΄ κ°€λ¥ν•΄μ§„λ‹¤.   

> ### DIP μμ΅΄ μ—­μ „ μ›μΉ™ (Dependency Inversion Principle, DIP)
> κµ¬ν„ λ³΄λ‹¤λ” μΈν„°νμ΄μ¤μ— λ§μ¶°μ„ ν”„λ΅κ·Έλλ°μ„ ν•λ‹¤.
> λ‹¤μ‹ λ§ν•΄ κµ¬ν„μ²΄λ¥Ό μμ΅΄ν•μ§€ λ§κ³ , μΈν„°νμ΄μ¤μ— μμ΅΄μ„ ν•λΌ
>
> μ΄λ¥Ό ν†µν•΄ ν΄λΌμ΄μ–ΈνΈκ°€ κµ¬ν„μ²΄λ¥Ό μμ΅΄μ„ ν•λ‹¤λ©΄ λ³€κ²½μ— μμ–΄ μ–΄λ ¤μ›€μ΄ μƒκΈ°μ§€λ§, μΈν„°νμ΄μ¤μ— μμ΅΄μ„ ν•λ‹¤λ©΄ λ³΄λ‹¤ μ μ—°ν•κ² κµ¬ν„μ²΄κ°€ λ³€κ²½λ  μ μλ‹¤.

μμ  μ½”λ“λ¥Ό ν†µν•΄ μμ„Έν μ•μ•„λ³΄μ.

```java
public class Main {
    public static void main(String[] args) {
        UserRepository userRepository = new MySQLUserRepository();
        
        UserService userService = new UserService(userRepository);
        
        User user = new User("John Doe");
        userService.saveUser(user);
    }
}
```

μ„ μμ  μ½”λ“μ—μ„ `UserService`λ” μ§μ ‘μ μΌλ΅ `MySQLUserRepository`μ— λ€ν•΄ μμ΅΄ν•κ³  μμ§€ μ•κ³ , μΈν„°νμ΄μ¤μΈ `UserRepository`μ— λ€ν•μ—¬ μμ΅΄μ„ ν•κ³  μλ” μƒν™©μ΄λ‹¤.   

μ—¬κΈ°μ„ κΈ°μ΅΄μ `MySQLUserRepository` λ§κ³  `MongoDBUserRepository`μΌλ΅ λ³€κ²½μ„ ν•λ‹¤λ©΄ 

```java
UserRepository userRepository = new MongoDBUserRepository();
```

μμ  μ½”λ“κ°€ μ™ κ°€λ¥ν•μ§€ κ¶κΈν•  μ μκΈ°μ— μ¶”κ°€μ μΌλ΅ `LSP`μ— λ€ν•΄μ„ μ§§κ² μ„¤λ…μ„ ν•κ² λ‹¤.

> λ¦¬μ¤μ½”ν”„ μΉν™ μ›μΉ™ (Liskov Substitution Principle, LSP)
> μμ‹ νƒ€μ…μ κ°μ²΄λ” λ¶€λ¨ νƒ€μ… κ°μ²΄μ—μ„ λ™μ‘ κ°€λ¥ν• ν–‰μ„λ¥Ό μν–‰ ν•  μ μλ‹¤.
> 
> μ—¬κΈ°μ„ `MongoDBUserRepository`λ” `UserRepository`μ κµ¬ν„μ²΄μ΄λ‹¤. κ·Έλ ‡κΈ° λ•λ¬Έμ— ν•΄λ‹Ή λ™μ‘μ΄ κ°€λ¥ν•λ‹¤.
> ```java
>   UserRepository userRepository = new UserRepository();    
>   // μƒμ„ νƒ€μ… κ°μ²΄
>   UserRepository userRepository = new MongoDBUserRepository(); 
>   // LSP μ›μΉ™μ— μκ±°ν•μ—¬ κ°€λ¥ν• λ™μ‘
> ```

κΈ°μ΅΄μ λ°©μ‹μΈ κµ¬ν„μ²΄λ¥Ό μ§μ ‘ μμ΅΄ν•λ” λ°©λ²•μ€ `OOP`μ— μλ” μ—¬λ¬ μ›μΉ™μ„ μ„λ°°ν•κ² λλ©΄μ„ ν™•μ¥μ„±κ³Ό μ μ§€ λ° λ³€κ²½μ— μμ–΄ μ—¬λ¬ λ¬Έμ μ μ΄ μμ—μ§€λ§, μΈν„°νμ΄μ¤λ¥Ό μμ΅΄ν•λ©΄μ„ μ—¬λ¬ λ¶€λ¶„μ— μ΄μ μ„ μ–»μ„ μ μκ² λμ—λ‹¤.   

## μΈν„°νμ΄μ¤ κµ¬ν„ κ΄€ν–‰κ³Ό Spring AOPμ κ΄€κ³„   

`Spring AOP`μ™€ ν”„λ΅μ‹ κ°μ²΄ μƒμ„± λ°©μ‹μ— λ€ν•΄ μ‚΄ν΄λ³΄λ©΄, `JDK Dynamic Proxy`λ” μΈν„°νμ΄μ¤ κΈ°λ°μΌλ΅ ν”„λ΅μ‹ κ°μ²΄λ¥Ό μƒμ„±ν•λ‹¤.   
μ¦‰, ν”„λ΅μ‹ κ°μ²΄λ¥Ό λ§λ“¤κΈ° μ„ν•΄μ„λ” λ°λ“μ‹ μΈν„°νμ΄μ¤κ°€ ν•„μ”ν•λ©°, μ΄λ΅ μΈν•΄ μ„λΉ„μ¤ ν΄λμ¤λ¥Ό μΈν„°νμ΄μ¤λ΅ κµ¬ν„ν•λ” κ²ƒμ΄ μΌλ°μ μΈ κ΄€ν–‰μ΄ λμ—λ‹¤.   

λ°λ©΄, `CGLib`λ” ν΄λμ¤ κΈ°λ°μΌλ΅ ν”„λ΅μ‹ κ°μ²΄λ¥Ό μƒμ„±ν•  μ μμ§€λ§ κ³Όκ±°μ—λ” μ—¬λ¬ λ¬Έμ (κΈ°λ³Έ μƒμ„±μ ν•„μ”, μƒμ„±μ λ‘ λ² νΈμ¶ λ“±)λ΅ μΈν•΄ `JDK Dynamic Proxy`κ°€ λ” κ¶μ¥λμ—λ‹¤.

κ·Έλ¬λ‚ `Spring 3.2` μ΄ν›„, `CGLib`μ λ¬Έμ μ μ΄ μ™Έλ¶€ λΌμ΄λΈλ¬λ¦¬μ κ°μ„ μΌλ΅ ν•΄κ²°λλ©΄μ„, μ΄λ΅ μΈν•΄ `Spring Boot`μ—μ„λ” μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν• ν΄λμ¤μ—μ„λ„ `CGLib`λ¥Ό μ‚¬μ©ν•μ—¬ λ” λ‚μ€ μ„±λ¥μ„ μ κ³µν•  μ μκ² λμ—λ‹¤.    

κΈ°λ³Έ μ„¤μ •μ΄ `CGLib`λ΅ λ³€κ²½λ¨μ— λ”°λΌ, μ΄μ λ” `JDK Dynamic Proxy`μ— μμ΅΄ν•μ§€ μ•κ³ λ„ ν”„λ΅μ‹ κ°μ²΄λ¥Ό μƒμ„±ν•  μ μκ² λμ—λ‹¤.

λ”°λΌμ„, μμ „λ¶€ν„° μ΄μ–΄μ Έ μ¨ `JDK Dynamic Proxy` κΈ°λ°μ ν”„λ΅μ‹ μ‚¬μ©μ„ μ„ν• κ΄€ν–‰μ€ μ΄μ  κ·Έ μλ―Έκ°€ μ•½ν•΄μ΅λ‹¤κ³  ν•  μ μλ‹¤.

