# Deploy Library using JitPack

## 개발 중 발생한 불편한 상황

현재 개인 프로젝트를 진행하고 있다.    
 
프로젝트를 시작하면서 _**'이것 저것 기술들을 사용해보자!'**_ 라는 마인드로 구현이 가능한 기술들을 사용하고 있다.

현재 `Monolithic Architecture`에서 `MSA(MicroService Architecture)`으로 전환을 하면서 기존에는 쉽게 해결되던 "공통 유틸리티 관리" 문제가 초래되었다.

![](https://i.postimg.cc/tCvG00XJ/image.jpg)

기존 아키택처에서는 큰 문제가 없었지만 여러 서비스 나누면서 각 도메인에서 사용되던 범용적인 유틸리티 관련 코드들을 각각의 서비스 내 정의를 해야할까? 아니면 획기적인 방안이 있을까?   

## 어떤 방안이 있을까?    

해당 문제에 대하여 해결 가능한 방법은 당장 크게 3가지 방법이라 생각을 한다.   
* 각각의 서비스 내 정의   
* 범용적인 유틸리티를 제공하는 서비스 작성   
* 범용적인 유틸리티를 제공하는 라이브러리 작성

위 방법 중 각각의 서비스 내 정의를 하는 방법이 가장 쉬운 방법이라 생각을 한다. 단순히 처음에 작성한 클래스 파일을 복사/붙여넣기 동작으로 여러 서비스 내 정의를 할 수 있을 것이다.     
그런데 만약 해당 코드가 양이 많고 수정해야 할 부분이 생긴다면 해결하기에 다소 귀찮은 일이 생기고 신속하게 해결하기에...   

다음 방법으로는 독립적인 공통의 서비스를 만들어서 해당 기능이 필요로 할 때 API를 이용하여 원하는 값을 얻어 사용하게 하는 방법이다. 뭐 앞선 방법에 비하여 중복되는 부분을 줄이고, 여러번의 수정이 아닌 Common Service만을 관리하면 된다는 장점이 있다고 생각한다. 하지만 API방식이기 때문에 네트워크 지연이 발생 할 수 있으며, 해당 서비스에 대한 의존이 커진다.   

개인적인 생각으로는 여러 방법 중 이 방법이 가장 좋다는 생각이 든다. 해당 방법은 공통 라이브러리로 만들어서 사용하는 방법이다. 아는 모든 서비스에서 동일한 코드를 쉽게 재사용이 가능하며, 버전 관리에도 유용하다고 생각을 한다.    

## Common Library    

지금까지 코드를 작성하면서 누군가 만들어둔 외부 라이브러리를 사용 했지만, 내가 직접 라이브러리를 만드는 것은 처음이다...

> 해당 관련 서적을 읽거나, 자세하게 배우지 않고 직접 시도하면서 알아가며 작성했기 때문에 틀린 부분이 다소 존재할 수 있습니다. 

### 1. 클래스 작성
공통 라이브러릴 만들기 위해 먼저 클래스를 만들어 코드를 작성했다.   

### 2. Gradle 설정   
![Build.gradle](https://i.postimg.cc/xdX6kCbD/2025-01-04-16-10-56.png)   

`Build.Gradle` 파일 내부에 몇 가지 설정을 추가를 해줘야 한다.   

`plugins`부분과 `publishing`을 추가적으로 설정해줘야 한다.   
  (해당 설정은 나중에 `JitPack`으로 배포하기 위한 설정이다.)

``` gradle
plugins {
    id 'java'
    id 'maven-publish'
}

publishing {
    publications {
        maven(MavenPublication) {
            groupId =  // 라이브러리가 속한 그룹
            artifactId = // 라이브러리의 이름
            version = // 라이브러리의 버전

            from components.java
        }
    }
}
```

### 3. Build   

인텔리제이 우측 사이드 바를 보면 Gradle아이콘이 있을 것이다. 해당 아이콘을 통해서 빌드를 진행하면 된다.   
` Tasks - build - build ` 

![](https://i.postimg.cc/L58Dp8Sb/2025-01-04-16-36-16.png)    

해당 과정을 거치면 로컬에 해당 `.jar` 파일이 생성이 된다.   

![](https://i.postimg.cc/Qx5mZwZs/2025-01-04-16-40-56.png)   

### 4. 라이브러리 사용    

1~3의 과정으로 `.jar`파일이 생성 되었다면 이제 해당 라이브러리를 사용 가능하다.    

해당 라이브러리를 사용하기 위해 생성된 `.jar`파일을 갖고와서 프로젝트 상단 폴더 내 옮겨주고 `build.gradle` 파일 내부에 해당 파일을 지정해주면 사용 준비 끝이다.

![](https://i.postimg.cc/QCqMpjWh/2025-01-04-16-47-44.png)

### 5. 라이브러리 배포하기    

라이브러리를 사용하기 위해서 프로젝트 내부에 해당 파일을 넣고 사용해도 큰 문제는 없다.   

일단 해당 라이브러리 배포를 하기 위해서는 Github 원격 레포지터리에 올려야 한다.   

[JitPack](https://jitpack.io/)에 접속하여 GitHub 레포지터리의 주소를 입력하여 검색을 하면 이와같이 나타난다.   

![](https://i.postimg.cc/sgG44LKb/2025-01-04-17-15-08.png)   

그러면 이제 해당 페이지 하단에 사용 방법에 따라 라이브러리를 사용하면 된다. 

#### 예시    

![](https://i.postimg.cc/63p7Y2tT/2025-01-04-17-17-10.png)   


---

위 과정을 바탕으로 하나의 프로젝트를 각각의 서비스로 나누어서 MSA로 변경하면 생기는 공통 유틸리티 관리를 하기 위해서 각 서비스에 작성하는 간단한 방법이 아닌 라이브러리화를 통하여 사용하는 방법에 대하여 직접 따라하며 간단한 메모? 정도의 글을 작성했다.    

나는 Java프로젝트로 라이브러리를 만들었지만 스프링부트를 바탕으로 작성한 글이 있어 아래에 주소를 남기겠다.

[$Reference$](https://docs.jitpack.io/building/)
